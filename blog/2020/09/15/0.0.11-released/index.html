<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Recoil Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Recoil Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-46","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-46","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>

<title data-react-helmet="true">Recoil 0.0.11 | Recoil</title>

<meta data-react-helmet="true" property="og:title" content="Recoil 0.0.11 | Recoil"><meta data-react-helmet="true" name="description" content="Today we are releasing Recoil 0.0.11. It contains bug fixes, new features, better performance, and experimental compatibility with Concurrent Mode. Thank you so much to everyone who contributed to this release!"><meta data-react-helmet="true" property="og:description" content="Today we are releasing Recoil 0.0.11. It contains bug fixes, new features, better performance, and experimental compatibility with Concurrent Mode. Thank you so much to everyone who contributed to this release!"><meta data-react-helmet="true" property="og:image" content="img/og-image.png"><meta data-react-helmet="true" property="twitter:image" content="img/og-image.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Recoil 0.0.11 | Recoil"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.371ff3ed.css">


<link rel="preload" href="/styles.bb1de23d.js" as="script">

<link rel="preload" href="/runtime~main.f60683fa.js" as="script">

<link rel="preload" href="/main.205c4962.js" as="script">

<link rel="preload" href="/1.0abb3584.js" as="script">

<link rel="preload" href="/2.add8350d.js" as="script">

<link rel="preload" href="/3.b92816e5.js" as="script">

<link rel="preload" href="/ccc49370.5ab08523.js" as="script">

<link rel="preload" href="/5e858c6d.224f7577.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">Recoil</strong></a><a class="navbar__item navbar__link" href="/docs/introduction/installation">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebookexperimental/Recoil" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Recoil</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/docs/introduction/installation">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" position="left" href="/blog">Blog</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebookexperimental/Recoil" class="menu__link" position="right">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--8 col--offset-2"><article><header><h1 class="margin-bottom--sm blogPostTitle_2RZH">Recoil 0.0.11</h1><div class="margin-vert--md"><time datetime="2020-09-15T00:00:00.000Z" class="blogPostDate_3tRe">September 15, 2020  · 6 min read</time></div><div class="avatar margin-vert--md"><div class="avatar__intro"></div></div></header><section class="markdown"><p>Today we are releasing Recoil 0.0.11. It contains bug fixes, new features, better performance, and experimental compatibility with Concurrent Mode. Thank you so much to everyone who contributed to this release!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="experimental-concurrent-mode-support"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#experimental-concurrent-mode-support" title="Direct link to heading">#</a>Experimental Concurrent Mode Support</h2><p>Recoil now supports <a href="https://reactjs.org/docs/concurrent-mode-intro.html">Concurrent Mode</a> when used with the <code>experimental</code> release of React. Please try this out and report any problems!</p><p>Concurrent Mode, which enables smoother, more consistent user experiences, is the future of React. But up until now it&#x27;s been incompatible with any kind of external state. This is because, in Concurrent Mode, renders can be spread out over time: React can pause the rendering of components, then later pick up where it left off, starting from the partial component tree that it already built:</p><img alt="React pauses while rendering a tree of components. Some components are rendered before the pause while others are rendered after the pause." src="/img/blog/2020-09-02-0.0.11-released/concurrent2.png"><p>This presents a problem with external state. Since React now relinquishes control flow, anything could happen between the time when rendering starts and when it is completed. If the external state changes during this time, it will result in an inconsistent UI, as the earlier-rendered components will observe the older state, while the later-rendered components will observe the new state:</p><img alt="If components depend on some external state, and that state changes while rendering is paused, then components rendered before the pause will observe the old state, while components rendered after the pause will observe the new state." src="/img/blog/2020-09-02-0.0.11-released/concurrent3.png"><p>This inconsistency could cause problems up to crashing the app.</p><p>Recoil now takes advantage of experimental APIs in React to handle this situation by restarting with a fresh tree when Recoil state has changed during a render. These APIs also make Recoil more efficient and remove the need to re-render components when they&#x27;re first mounted.</p><p>Avoid using React experimental releases in production.  And, no matter what release of React or state management library you use, <a href="https://gist.github.com/sebmarkbage/75f0838967cd003cd7f9ab938eb1958f">avoid bugs by always keeping side-effects in a <code>useEffect()</code> hook, not during render</a>!  (<a href="https://github.com/davidmccabe">@davidmccabe</a>, <a href="https://github.com/bvaughn">@bvaughn</a>)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="performance"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#performance" title="Direct link to heading">#</a>Performance</h2><p>Several changes improve Recoil&#x27;s performance. Previously, Recoil sometimes had to re-render components in certain circumstances: when reading from selectors that had unknown dependencies and when reading from atoms that had been initialized from external storage. Now, Recoil never has to perform a second render in response to reading an atom or selector. (<a href="https://github.com/davidmccabe">@davidmccabe</a>)</p><p>Secondly, when used with the <code>experimental</code> release of React, Recoil no longer has to perform a second render when components are initially mounted. Recoil also no longer has to do any work to look up atom or selector values when it re-renders for reasons other than that atom or selector changing. (<a href="https://github.com/davidmccabe">@davidmccabe</a>, <a href="https://github.com/bvaughn">@bvaughn</a>).</p><p>The basic hooks such as <code>useRecoilValue()</code> and <code>useRecoilState()</code> have been optimized and are now about 8× faster. They now typically take less than 2× as long as <code>useState()</code> to execute. This improves the performance of apps that use a large number of atoms in many components. (<a href="https://github.com/davidmccabe">@davidmccabe</a>)</p><p>Recoil recursively freezes the contents of atoms and selectors. This prevents bugs, but can be slow with large objects. It now happens only in the development build. (<a href="https://github.com/facebookexperimental/Recoil/pull/361">#361</a> — <a href="https://github.com/drarmstr">@drarmstr</a>)</p><p>Recoil now avoids re-rendering components or re-evaluating selectors if you set an atom to its already-set value or reset it when it is already reset (<a href="https://github.com/facebookexperimental/Recoil/pull/399">#399</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/386">#386</a> — <a href="https://github.com/drarmstr">@drarmstr</a>).</p><p>Finally, this release also fixes a memory leak introduced in the previous release. If you&#x27;ve been experiencing poor performance in apps that frequently update atoms, this was likely the cause. (<a href="https://github.com/facebookexperimental/Recoil/pull/471">#471</a> — <a href="https://github.com/davidmccabe">@davidmccabe</a>)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="types-and-packaging"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#types-and-packaging" title="Direct link to heading">#</a>Types and Packaging</h2><p><a href="https://flow.org/">Flow types</a> are now exported with the package in addition to TypeScript. Flow is the type system used at Facebook and that Recoil is actually written in. (<a href="https://github.com/facebookexperimental/Recoil/pull/338">#338</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/468">#468</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/541">#541</a> — <a href="https://github.com/Brianzchen">@Brianzchen</a>, <a href="https://github.com/Komalov">@Komalov</a>, <a href="https://github.com/mondaychen">@mondaychen</a>)</p><p>TypeScript typing is also improved (<a href="https://github.com/facebookexperimental/Recoil/pull/492">#492</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/545">#545</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/548">#548</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/568">#568</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/575">#575</a> — <a href="https://github.com/csantos42">@csantos42</a>, <a href="https://github.com/SergeyVolynkin">@SergeyVolynkin</a>, <a href="https://github.com/drarmstr">@drarmstr</a>, <a href="https://github.com/hachibeeDI">@hachibeeDI</a>).</p><p>In addition to NPM packages, we now provide <a href="/docs/introduction/installation#cdn">Common JS and UMD modules via CDN</a> (<a href="https://github.com/facebookexperimental/Recoil/pull/413">#413</a> — <a href="https://github.com/mondaychen">@mondaychen</a>, <a href="https://github.com/pocket7878">@pocket7878</a>).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="support-for-multiple-react-roots"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#support-for-multiple-react-roots" title="Direct link to heading">#</a>Support for Multiple React Roots</h2><p>You can now <a href="/docs/api-reference/core/useRecoilBridgeAcrossReactRoots">share state between multiple React roots</a>.  For example, if your app uses both React DOM and another renderer such as ThreeJS, you can now share Recoil state between them. As always when using multiple React roots, they may be momentarily out of sync. (<a href="https://github.com/facebookexperimental/Recoil/pull/298">#298</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/516">#516</a> — <a href="https://github.com/drarmstr">@drarmstr</a>, <a href="https://github.com/inlet">@inlet</a>)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="developer-tool-apis"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#developer-tool-apis" title="Direct link to heading">#</a>Developer Tool APIs</h2><p>This release includes <a href="/docs/api-reference/core/Snapshot#developer-tools">experimental APIs</a> intended for developer tools. We are creating a set of developer tools internally and there are also multiple open-source projects underway. We are releasing these APIs to help validate their design. (<a href="https://github.com/drarmstr">@drarmstr</a>)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="other-new-apis"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#other-new-apis" title="Direct link to heading">#</a>Other New APIs</h2><p>You can now use a Promise as the default value of an atom. When read it will behave like an async selector. (<a href="https://github.com/drarmstr">@drarmstr</a>)</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="bug-fixes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#bug-fixes" title="Direct link to heading">#</a>Bug Fixes</h2><p>This update has many fixes related to test infrastructure and differences between the open-source and Facebook-internal environments. (<a href="https://github.com/facebookexperimental/Recoil/pull/368">#368</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/360">#360</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/362">#362</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/363">#363</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/392">#392</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/431">#431</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/402">#402</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/538">#538</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/539">#539</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/549">#549</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/561">#561</a>, <a href="https://github.com/facebookexperimental/Recoil/pull/576">#576</a> — <a href="https://github.com/aaronabramov">@aaronabramov</a>, <a href="https://github.com/Komalov">@Komalov</a>, <a href="https://github.com/drarmstr">@drarmstr</a>, <a href="https://github.com/jacques-blom">@jacques-blom</a>, <a href="https://github.com/mondaychen">@mondaychen</a>, <a href="https://github.com/dsainati1">@dsainati1</a>, <a href="https://github.com/csantos42">@csantos42</a>, <a href="https://github.com/behnammodi">@behnammodi</a>, <a href="https://github.com/habond">@habond</a>, <a href="https://github.com/benhalverson">@benhalverson</a>).</p><p>It also fixes bugs when using multiple <code>&lt;RecoilRoot&gt;</code>s or pre-loading selectors in a snapshot (<a href="https://github.com/facebookexperimental/Recoil/pull/534">#534</a> — <a href="https://github.com/davemccabe">@davemccabe</a>).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="breaking-changes"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#breaking-changes" title="Direct link to heading">#</a>Breaking Changes</h2><p>This update may break certain tests that don&#x27;t use the <a href="https://reactjs.org/docs/test-utils.html#act"><code>act()</code> function from <code>react-test-utils</code></a> to perform actions affecting React components. These tests sometimes worked anyway due to Recoil&#x27;s extra renders. Use <code>act()</code> to fix any such tests.</p><p>Recoil will now throw an exception if a state updater function provided to Recoil causes another atom update within its own execution. State updater functions are supposed to be pure, so this has always been against the API contract. But it happened to work in some cases before, and now it doesn&#x27;t. Code that does this can be changed to perform the effects with <code>useRecoilCallback()</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="future-work"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#future-work" title="Direct link to heading">#</a>Future Work</h2><p>In a future release, Recoil will automatically free the memory used by atoms and selectors that are no longer used, and will perform better with larger numbers of atoms. (<a href="https://github.com/davidmccabe">@davidmccabe</a>)</p><p>We are also working on APIs for synchronizing Recoil atoms with external data sources such as the URL, local storage, or a server. (<a href="https://github.com/drarmstr">@drarmstr</a>)</p><p>Developer tools are in development. (<a href="https://github.com/maxijb">@maxijb</a>, <a href="https://github.com/habond">@habond</a>, <a href="https://github.com/drarmstr">@drarmstr</a>)</p><p>Thanks for reading this far and for using Recoil! More releases are coming soon.</p></section></article><div><a href="https://github.com/facebookexperimental/Recoil/edit/docs/docs/blog/blog/2020-09-15-0.0.11-released.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2020/06/18/0.0.10-released"><div class="pagination-nav__link--sublabel">Next Post</div><div class="pagination-nav__link--label">Recoil 0.0.10 »</div></a></div></nav></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/core-concepts">Core Concepts</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/recoiljs">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/facebookexperimental/Recoil">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noreferrer noopener" href="https://opensource.facebook.com/legal/privacy/">Privacy</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noreferrer noopener" href="https://opensource.facebook.com/legal/terms/">Terms</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div>Copyright © 2020 Facebook, Inc. Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.bb1de23d.js"></script>

<script src="/runtime~main.f60683fa.js"></script>

<script src="/main.205c4962.js"></script>

<script src="/1.0abb3584.js"></script>

<script src="/2.add8350d.js"></script>

<script src="/3.b92816e5.js"></script>

<script src="/ccc49370.5ab08523.js"></script>

<script src="/5e858c6d.224f7577.js"></script>


</body>
</html>